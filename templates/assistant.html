<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Uyku Bilgi Asistanı — SleepCoach.AI</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" />

  <style>
    :root{
      --card:#ffffff; --text:#1f2937; --muted:#6b7280;
      --primary:#6c63ff; --primary-2:#8d7bff; --ring:rgba(108,99,255,.35);
      --hero-img:url("/static/img/hero-night.png");
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial; color:var(--text)}
    a{color:inherit; text-decoration:none}
    .container{max-width:1100px; margin:0 auto; padding:0 20px}

    /* sayfa arkaplanı */
    .page-bg{
      position:fixed; inset:0; z-index:-1;
      background-image:
        linear-gradient(135deg, rgba(108,99,255,.92), rgba(159,139,255,.88) 40%, rgba(201,186,255,.85)),
        var(--hero-img);
      background-size:cover; background-position:center; background-repeat:no-repeat;
      background-attachment:fixed;
    }

    /* navbar */
    .nav{
      position:sticky; top:0; z-index:1000;
      background:rgba(255,255,255,.88);
      backdrop-filter:saturate(180%) blur(10px);
      border-bottom:1px solid rgba(0,0,0,.06);
      box-shadow:0 6px 22px rgba(17,24,39,.06);
    }
    .nav-inner{
      display:grid; grid-template-columns:1fr auto 1fr;
      align-items:center; gap:14px; padding:14px 0;
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; font-size:22px}
    .brand .dot{width:8px; height:8px; border-radius:50%; background:#77b3ff}
    .links{justify-self:center; display:flex; gap:18px; flex-wrap:wrap}
    .links a{color:#6b7280; font-weight:500; padding:8px 10px; border-radius:10px}
    .links a:hover{background:rgba(59,47,224,.06); color:#3b2fe0}
    .actions{justify-self:end; display:flex; gap:10px; align-items:center}
    .btn{
      display:inline-flex; align-items:center; gap:8px; height:40px;
      padding:0 16px; border-radius:12px; font-weight:600; border:0; cursor:pointer;
      transition:transform .16s, box-shadow .16s, background .2s, color .2s;
    }
    .btn:active{transform:translateY(1px) scale(.98)}
    .btn-outline{background:transparent; color:#3b2fe0; border:1px solid rgba(59,47,224,.25)}
    .btn-outline:hover{background:rgba(59,47,224,.06)}
    .btn-cta{background:linear-gradient(135deg, var(--primary), var(--primary-2)); color:#fff; box-shadow:0 8px 22px rgba(108,99,255,.25)}
    .btn-cta:hover{box-shadow:0 10px 28px rgba(108,99,255,.33)}

    /* sayfa üst başlık */
    .hero-mini{color:#fff; padding:48px 0 10px}
    .hero-mini h1{margin:0 0 6px; font-size:36px}
    .muted-light{color:#eef2ff}

    /* kart / içerik */
    .section{padding:22px 0 36px}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,.62));
      border:1px solid rgba(0,0,0,.06); border-radius:18px; padding:18px;
      box-shadow:0 10px 30px rgba(10,16,34,.08);
    }
    .muted{color:#6b7280}

    /* form parçaları */
    .row{display:flex; gap:10px; align-items:center}
    input[type="search"]{
      flex:1; padding:12px 14px; border:1px solid #e5e7eb; border-radius:10px;
      font-size:16px; outline:none;
    }
    input[type="search"]:focus{box-shadow:0 0 0 4px rgba(108,99,255,.12); border-color:#c7ccff}

    .chip{
      border:1px solid #eee; border-radius:999px; padding:6px 10px; background:#fafafa;
      cursor:pointer; font-size:14px;
    }

    /* cevap alanı */
    #ragAnswer{background:#fbfbfb; border:1px solid #eee; border-radius:10px; padding:12px}
    #ragCitations{margin:0; padding-left:18px}

    footer{padding:26px 0; color:#eef2ff}
  </style>
</head>
<body>
  <div class="page-bg"></div>

  <!-- NAV -->
  <nav class="nav" aria-label="Ana gezinme">
    <div class="container nav-inner">
      <a class="brand" href="/"><span>🌙</span> SleepCoach.AI <span class="dot"></span></a>

      <div class="links" id="navLinks">
        <a href="/">Ana Sayfa</a>
        <a href="/assessment">Değerlendirme</a>
      </div>

      <div class="actions">
        <a class="btn btn-outline" href="/">Geri Dön</a>
        <a class="btn btn-cta" href="/assessment">Değerlendirmeyi Başlat</a>
      </div>
    </div>
  </nav>

  <!-- ÜST BAŞLIK -->
  <header class="hero-mini">
    <div class="container">
      <h1>🔎 Uyku Bilgi Asistanı</h1>
      <div class="muted-light">Kanıta dayalı, <b>kaynaklı</b> kısa yanıtlar. Bir soru yazın veya örneklerden seçin.</div>
    </div>
  </header>

  <!-- ASİSTAN İÇERİĞİ -->
  <main class="container section">
    <div class="card">
      <form id="ragForm" autocomplete="off">
        <div class="row">
          <input id="q" name="q" type="search"
                 placeholder="Örn. Kafeini saat kaçta kesmeliyim? Mavi ışık uykuyu nasıl etkiler?"
                 required />
          <button class="btn btn-cta" id="ragBtn" type="submit">Kaynaklı Yanıt Al</button>
        </div>

        <div class="muted" style="margin:10px 0 6px;">Örnekler</div>
        <div id="ragChips" style="display:flex; flex-wrap:wrap; gap:8px;">
          <button type="button" class="chip" data-q="Kafeini saat kaçta kesmeliyim? Akşam kahve uyku kalitesini etkiler mi?">Kafein</button>
          <button type="button" class="chip" data-q="Mavi ışık uykuyu nasıl etkiler? Ekranı yatmadan ne kadar önce bırakmalıyım?">Mavi ışık</button>
          <button type="button" class="chip" data-q="CBT-I nedir? Uygulaması nasıldır?">CBT-I</button>
          <button type="button" class="chip" data-q="Geç saat egzersiz uykuyu bozar mı? En geç kaçta bitirmeliyim?">Geç egzersiz</button>
          <button type="button" class="chip" data-q="Gündüz şekerlemesi ne kadar sürmeli? Kaçta yapmak ideal?">Gündüz uykusu</button>
        </div>

        <div id="ragStatus" class="muted" style="min-height:18px;"></div>
      </form>
    </div>

    <div class="card" id="ragResult" style="display:none; margin-top:12px;">
      <h3 style="margin:0 0 8px;">Yanıt</h3>
      <div id="ragAnswer"></div>

      <div class="muted" style="margin:12px 0 6px;">Kaynaklar</div>
      <ul id="ragCitations"></ul>

      <details style="margin-top:8px;">
        <summary class="muted" style="cursor:pointer;">Gelen parçalar (debug)</summary>
        <pre id="ragChunks" style="white-space:pre-wrap; font-size:12px; background:#f6f6f6; border:1px solid #eee; border-radius:8px; padding:10px; overflow:auto;"></pre>
      </details>

      <div class="muted" style="margin-top:10px; font-size:12px;">
        ⚕️ Bu içerik bilgilendirme amaçlıdır, tıbbi tavsiye değildir.
      </div>
    </div>
  </main>

  <footer class="container">© 2025 SleepCoach.AI · Gizlilik · İletişim</footer>

  <!-- RAG client -->
    <script>
    window.RAG_DOCS_BASE = "/rag/";
    window.RAG_VIEW_BASE = "/rag/view/";
    </script>
  <script src="/static/js/rag.js"></script>
  <script>
    // örnek chip’leri inputa bas
    document.querySelectorAll('#ragChips .chip').forEach(chip=>{
      chip.addEventListener('click', ()=>{
        const v = chip.getAttribute('data-q') || chip.textContent.trim();
        const input = document.getElementById('q');
        input.value = v;
        input.focus();
      });
    });
  </script>
</body>
</html>
